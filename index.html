<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario Editorial CR7</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .cr7-calendar {
            background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)), 
                    url('https://hips.hearstapps.com/hmg-prod/images/cristiano-ronaldo-of-portugal-looks-dejected-following-news-photo-1624346993.jpg?crop=1.00xw:0.649xh;0,0.0303xh&resize=640:*') center/cover;            
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
        }
        
        .status-planificado { 
            background: linear-gradient(45deg, #dbeafe, #bfdbfe); 
            color: #1e40af; 
            border: 1px solid #93c5fd; 
        }
        .status-en_progreso { 
            background: linear-gradient(45deg, #fef3c7, #fde68a); 
            color: #92400e; 
            border: 1px solid #fcd34d; 
        }
        .status-revision { 
            background: linear-gradient(45deg, #e9d5ff, #ddd6fe); 
            color: #7c3aed; 
            border: 1px solid #c4b5fd; 
        }
        .status-completado { 
            background: linear-gradient(45deg, #d1fae5, #a7f3d0); 
            color: #065f46; 
            border: 1px solid #86efac; 
        }
        
        .platform-Blog { background: linear-gradient(45deg, #6b7280, #9ca3af); }
        .platform-Instagram { background: linear-gradient(45deg, #ec4899, #f472b6); }
        .platform-LinkedIn { background: linear-gradient(45deg, #2563eb, #3b82f6); }
        .platform-Twitter { background: linear-gradient(45deg, #1da1f2, #60a5fa); }
        .platform-Facebook { background: linear-gradient(45deg, #1877f2, #3b82f6); }
        .platform-YouTube { background: linear-gradient(45deg, #dc2626, #ef4444); }
        .platform-TikTok { background: linear-gradient(45deg, #000000, #374151); }
        
        .calendar-day {
            height: 80px;
            max-height: 80px;
            border: 1px solid #e5e7eb;
            padding: 4px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .calendar-day:hover {
            background-color: #f8fafc;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        @media (max-width: 768px) {
            .calendar-day {
                height: 60px;
                max-height: 60px;
                padding: 2px;
            }
            
            .calendar-day .text-sm {
                font-size: 10px;
            }
        }
        
        .today {
            background: linear-gradient(135deg, #eff6ff, #dbeafe);
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }
        
        .post-item {
            font-size: 9px;
            padding: 1px 4px;
            border-radius: 4px;
            margin-bottom: 1px;
            cursor: pointer;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            display: block;
            max-width: 100%;
        }
        
        .post-item:hover {
            transform: scale(1.01);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
            z-index: 10;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 16px;
            backdrop-filter: blur(4px);
        }
        
        .modal.show {
            display: flex;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            padding: 24px;
            border-radius: 12px;
            width: 100%;
            max-width: 550px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @media (max-width: 640px) {
            .modal-content {
                padding: 20px;
                max-height: 95vh;
            }
        }
        
        .btn {
            padding: 10px 18px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
        }
        
        .btn:hover:before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #e5e7eb, #d1d5db);
            color: #374151;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #d1d5db, #c1c6d0);
            transform: translateY(-1px);
        }
        
        .input {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        .grid-7 {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }
        
        .hidden {
            display: none;
        }
        
        .stats-card {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 2000;
            transform: translateX(400px);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        /* Responsividad mejorada */
        @media (max-width: 768px) {
            .max-w-7xl {
                padding: 8px;
            }
            
            .p-6 {
                padding: 12px;
            }
            
            .space-x-3 > * + * {
                margin-left: 6px;
            }
            
            .gap-4 {
                gap: 6px;
            }
            
            .text-2xl {
                font-size: 18px;
            }
            
            .btn {
                padding: 8px 14px;
                font-size: 13px;
            }
            
            .grid-cols-2 {
                grid-template-columns: 1fr;
            }
            
            .flex-wrap {
                flex-direction: column;
                align-items: stretch;
            }
            
            .space-x-2 > * + * {
                margin-left: 0;
                margin-top: 6px;
            }
        }
        
        @media (max-width: 640px) {
            .grid-7 {
                font-size: 10px;
            }
            
            .post-item {
                font-size: 7px;
                padding: 1px 3px;
                margin-bottom: 1px;
            }
            
            .calendar-day {
                height: 55px;
                max-height: 55px;
                padding: 2px;
            }
            
            .calendar-day .text-sm {
                font-size: 9px;
                line-height: 1;
                margin-bottom: 2px;
            }
        }
        
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .cr7-header {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            color: white;
            border-radius: 12px 12px 0 0;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen">
    <div class="max-w-7xl mx-auto p-6">
        <div class="bg-white rounded-lg shadow-xl border cr7-calendar overflow-hidden">
            <!-- Header mejorado -->
            <div class="cr7-header p-6">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center space-x-4">
                        <div class="p-2 bg-white bg-opacity-20 rounded-lg">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold">üìÖ Calendario Editorial CR7 ‚öΩ</h1>
                            <p class="text-blue-100 text-sm">Gestiona tu contenido como un campe√≥n</p>
                        </div>
                    </div>
                    <button onclick="openForm()" class="btn btn-primary flex items-center space-x-2 bg-white bg-opacity-20 text-white border-white border hover:bg-opacity-30">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        <span>Nuevo Post</span>
                    </button>
                </div>

                <!-- Estad√≠sticas r√°pidas -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="stats-card bg-white bg-opacity-20 border-white border-opacity-30 text-white">
                        <div class="text-2xl font-bold" id="totalPosts">0</div>
                        <div class="text-sm text-blue-100">Total Posts</div>
                    </div>
                    <div class="stats-card bg-white bg-opacity-20 border-white border-opacity-30 text-white">
                        <div class="text-2xl font-bold" id="completedPosts">0</div>
                        <div class="text-sm text-blue-100">Completados</div>
                    </div>
                    <div class="stats-card bg-white bg-opacity-20 border-white border-opacity-30 text-white">
                        <div class="text-2xl font-bold" id="inProgressPosts">0</div>
                        <div class="text-sm text-blue-100">En Progreso</div>
                    </div>
                    <div class="stats-card bg-white bg-opacity-20 border-white border-opacity-30 text-white">
                        <div class="text-2xl font-bold" id="plannedPosts">0</div>
                        <div class="text-sm text-blue-100">Planificados</div>
                    </div>
                </div>

                <!-- Controles -->
                <div class="flex flex-wrap items-center gap-4">
                    <div class="flex items-center space-x-2 flex-1 min-w-60">
                        <svg class="w-5 h-5 text-blue-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input 
                            type="text" 
                            id="searchInput" 
                            placeholder="Buscar contenido..." 
                            class="input flex-1 bg-white bg-opacity-20 border-white border-opacity-30 text-white placeholder-blue-200" 
                            onkeyup="filterPosts()"
                        >
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <svg class="w-5 h-5 text-blue-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <polygon points="22,3 2,3 10,12.46 10,19 14,21 14,12.46"></polygon>
                        </svg>
                        <select id="filterStatus" class="input bg-white bg-opacity-20 border-white border-opacity-30 text-white" onchange="filterPosts()">
                            <option value="todos">Todos los estados</option>
                            <option value="planificado">Planificado</option>
                            <option value="en_progreso">En Progreso</option>
                            <option value="revision">En Revisi√≥n</option>
                            <option value="completado">Completado</option>
                        </select>
                    </div>

                    <div class="flex items-center space-x-3">
                        <button onclick="previousMonth()" class="btn btn-secondary bg-white bg-opacity-20 border-white border-opacity-30 text-white hover:bg-opacity-30">‚Äπ</button>
                        <span id="currentMonth" class="font-bold text-lg px-4">Agosto 2025</span>
                        <button onclick="nextMonth()" class="btn btn-secondary bg-white bg-opacity-20 border-white border-opacity-30 text-white hover:bg-opacity-30">‚Ä∫</button>
                    </div>
                </div>
            </div>

            <!-- Calendario -->
            <div class="p-6">
                <div class="grid-7 border border-gray-200 rounded-lg overflow-hidden shadow-sm">
                    <!-- D√≠as de la semana -->
                    <div class="bg-gray-100 p-3 text-center text-sm font-bold text-gray-700 border-r border-gray-200">Dom</div>
                    <div class="bg-gray-100 p-3 text-center text-sm font-bold text-gray-700 border-r border-gray-200">Lun</div>
                    <div class="bg-gray-100 p-3 text-center text-sm font-bold text-gray-700 border-r border-gray-200">Mar</div>
                    <div class="bg-gray-100 p-3 text-center text-sm font-bold text-gray-700 border-r border-gray-200">Mi√©</div>
                    <div class="bg-gray-100 p-3 text-center text-sm font-bold text-gray-700 border-r border-gray-200">Jue</div>
                    <div class="bg-gray-100 p-3 text-center text-sm font-bold text-gray-700 border-r border-gray-200">Vie</div>
                    <div class="bg-gray-100 p-3 text-center text-sm font-bold text-gray-700">S√°b</div>
                    
                    <!-- Grid del calendario -->
                    <div id="calendarGrid" class="contents">
                        <!-- Se genera din√°micamente -->
                    </div>
                </div>
            </div>

            <!-- Lista de posts -->
            <div class="border-t border-gray-200 p-6 bg-gray-50">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">üìã Lista de Contenido</h3>
                    <div class="flex items-center space-x-2">
                        <select id="sortBy" class="input text-sm" onchange="renderPostsList()">
                            <option value="date">Ordenar por fecha</option>
                            <option value="title">Ordenar por t√≠tulo</option>
                            <option value="platform">Ordenar por plataforma</option>
                            <option value="status">Ordenar por estado</option>
                        </select>
                    </div>
                </div>
                <div id="postsList" class="space-y-4">
                    <!-- Se genera din√°micamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal mejorado -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 id="modalTitle" class="text-xl font-bold text-gray-900">Nuevo Post</h3>
                    <p class="text-sm text-gray-600">Completa la informaci√≥n del contenido</p>
                </div>
                <button onclick="closeForm()" class="text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>

            <div class="space-y-5">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">T√≠tulo *</label>
                    <input type="text" id="formTitle" class="input" placeholder="Ej: Nueva estrategia de marketing" required>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Plataforma *</label>
                        <select id="formPlatform" class="input" required>
                            <option value="">Seleccionar...</option>
                            <option value="Blog">üìù Blog</option>
                            <option value="Instagram">üì∏ Instagram</option>
                            <option value="LinkedIn">üíº LinkedIn</option>
                            <option value="Twitter">üê¶ Twitter</option>
                            <option value="Facebook">üìò Facebook</option>
                            <option value="YouTube">üì∫ YouTube</option>
                            <option value="TikTok">üéµ TikTok</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Estado</label>
                        <select id="formStatus" class="input">
                            <option value="planificado">üìã Planificado</option>
                            <option value="en_progreso">‚ö° En Progreso</option>
                            <option value="revision">üëÄ En Revisi√≥n</option>
                            <option value="completado">‚úÖ Completado</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Fecha *</label>
                        <input type="date" id="formDate" class="input" required>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Autor</label>
                        <input type="text" id="formAuthor" class="input" placeholder="Nombre del autor">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Categor√≠a</label>
                    <input type="text" id="formCategory" class="input" placeholder="Ej: Marketing, Tutoriales, Noticias">
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Notas</label>
                    <textarea id="formNotes" class="input" rows="4" placeholder="Notas adicionales, ideas, palabras clave..."></textarea>
                </div>

                <div class="flex space-x-4 pt-6 border-t">
                    <button onclick="savePost()" class="btn btn-primary flex-1">
                        <span id="saveButtonText">Crear Post</span>
                    </button>
                    <button onclick="closeForm()" class="btn btn-secondary flex-1">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notificaci√≥n -->
    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>

    <script>
        // Almacenamiento local mejorado
        const STORAGE_KEY = 'cr7_calendar_posts';
        
        function savePosts() {
            try {
                const dataToSave = {
                    posts: posts,
                    lastModified: new Date().toISOString()
                };
                sessionStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
                console.log('Posts guardados exitosamente');
            } catch (error) {
                console.error('Error al guardar posts:', error);
                showNotification('Error al guardar los datos', 'error');
            }
        }

        function loadPosts() {
            try {
                const savedData = sessionStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    posts = parsedData.posts || [];
                    console.log('Posts cargados:', posts.length);
                } else {
                    // Posts por defecto con m√°s variedad
                    posts = [
                        {
                            id: 1,
                            title: "üöÄ Tendencias de marketing 2025",
                            platform: "Blog",
                            date: "2025-08-15",
                            status: "planificado",
                            category: "Marketing",
                            author: "Equipo CR7",
                            notes: "Incluir estad√≠sticas recientes y casos de estudio"
                        },
                        {
                            id: 2,
                            title: "üí™ Tips de productividad para campeones",
                            platform: "LinkedIn",
                            date: "2025-08-16",
                            status: "en_progreso",
                            category: "Productividad",
                            author: "Ana Mart√≠nez",
                            notes: "Post con carousel de 5 tips"
                        },
                        {
                            id: 3,
                            title: "üèÜ Caso de √©xito: Cliente estrella",
                            platform: "Instagram",
                            date: "2025-08-17",
                            status: "completado",
                            category: "Casos de √©xito",
                            author: "Carlos L√≥pez",
                            notes: "Stories + post principal + reels"
                        },
                        {
                            id: 4,
                            title: "‚öΩ Motivaci√≥n diaria CR7",
                            platform: "Twitter",
                            date: "2025-08-18",
                            status: "revision",
                            category: "Motivaci√≥n",
                            author: "Team Social",
                            notes: "Serie de tweets inspiracionales"
                        }
                    ];
                    savePosts();
                }
            } catch (error) {
                console.error('Error al cargar posts:', error);
                posts = [];
                showNotification('Error al cargar los datos', 'error');
            }
        }

        let posts = [];
        let currentMonth = 7; // Agosto (0-indexado)
        let currentYear = 2025;
        let editingId = null;

        const monthNames = [
            'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
            'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
        ];

        const statusLabels = {
            'planificado': 'üìã Planificado',
            'en_progreso': '‚ö° En Progreso',
            'revision': 'üëÄ En Revisi√≥n',
            'completado': '‚úÖ Completado'
        };

        const platformEmojis = {
            'Blog': 'üìù',
            'Instagram': 'üì∏',
            'LinkedIn': 'üíº',
            'Twitter': 'üê¶',
            'Facebook': 'üìò',
            'YouTube': 'üì∫',
            'TikTok': 'üéµ'
        };

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function updateStats() {
            const totalPosts = posts.length;
            const completedPosts = posts.filter(p => p.status === 'completado').length;
            const inProgressPosts = posts.filter(p => p.status === 'en_progreso').length;
            const plannedPosts = posts.filter(p => p.status === 'planificado').length;
            
            document.getElementById('totalPosts').textContent = totalPosts;
            document.getElementById('completedPosts').textContent = completedPosts;
            document.getElementById('inProgressPosts').textContent = inProgressPosts;
            document.getElementById('plannedPosts').textContent = plannedPosts;
        }

        function renderCalendar() {
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            
            document.getElementById('currentMonth').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            
            let html = '';
            
            // D√≠as vac√≠os al inicio
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="calendar-day bg-gray-50"></div>';
            }
            
            // D√≠as del mes
            for (let date = 1; date <= daysInMonth; date++) {
                const dateString = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`;

